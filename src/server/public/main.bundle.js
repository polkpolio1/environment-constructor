!function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,n){!function(e,t){if(!T[e]||!_[e])return;for(var n in _[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(f[n]=t[n]);0==--v&&0===m&&O()}(e,n),t&&t(e,n)};var n,o=!0,r="540fc34e9e25df9a8705",i=1e4,s={},a=[],c=[];function d(e){var t=w[e];if(!t)return R;var o=function(o){return t.hot.active?(w[o]?-1===w[o].parents.indexOf(e)&&w[o].parents.push(e):(a=[e],n=o),-1===t.children.indexOf(o)&&t.children.push(o)):(console.warn("[HMR] unexpected require("+o+") from disposed module "+e),a=[]),R(o)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return R[e]},set:function(t){R[e]=t}}};for(var i in R)Object.prototype.hasOwnProperty.call(R,i)&&"e"!==i&&Object.defineProperty(o,i,r(i));return o.e=function(e){return"ready"===p&&u("prepare"),m++,R.e(e).then(t,function(e){throw t(),e});function t(){m--,"prepare"===p&&(y[e]||g(e),0===m&&0===v&&O())}},o}var l=[],p="idle";function u(e){p=e;for(var t=0;t<l.length;t++)l[t].call(null,e)}var E,f,h,v=0,m=0,y={},_={},T={};function b(e){return+e+""===e?+e:e}function C(e){if("idle"!==p)throw new Error("check() is only allowed in idle status");return o=e,u("check"),(t=i,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var o=new XMLHttpRequest,i=R.p+""+r+".hot-update.json";o.open("GET",i,!0),o.timeout=t,o.send(null)}catch(e){return n(e)}o.onreadystatechange=function(){if(4===o.readyState)if(0===o.status)n(new Error("Manifest request to "+i+" timed out."));else if(404===o.status)e();else if(200!==o.status&&304!==o.status)n(new Error("Manifest request to "+i+" failed."));else{try{var t=JSON.parse(o.responseText)}catch(e){return void n(e)}e(t)}}})).then(function(e){if(!e)return u("idle"),null;_={},y={},T=e.c,h=e.h,u("prepare");var t=new Promise(function(e,t){E={resolve:e,reject:t}});f={};return g(0),"prepare"===p&&0===m&&0===v&&O(),t});var t}function g(e){T[e]?(_[e]=!0,v++,function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.charset="utf-8",n.src=R.p+""+e+"."+r+".hot-update.js",t.appendChild(n)}(e)):y[e]=!0}function O(){u("ready");var e=E;if(E=null,e)if(o)Promise.resolve().then(function(){return D(o)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in f)Object.prototype.hasOwnProperty.call(f,n)&&t.push(b(n));e.resolve(t)}}function D(t){if("ready"!==p)throw new Error("apply() is only allowed in ready status");var n,o,i,c,d;function l(e){for(var t=[e],n={},o=t.slice().map(function(e){return{chain:[e],id:e}});o.length>0;){var r=o.pop(),i=r.id,s=r.chain;if((c=w[i])&&!c.hot._selfAccepted){if(c.hot._selfDeclined)return{type:"self-declined",chain:s,moduleId:i};if(c.hot._main)return{type:"unaccepted",chain:s,moduleId:i};for(var a=0;a<c.parents.length;a++){var d=c.parents[a],l=w[d];if(l){if(l.hot._declinedDependencies[i])return{type:"declined",chain:s.concat([d]),moduleId:i,parentId:d};-1===t.indexOf(d)&&(l.hot._acceptedDependencies[i]?(n[d]||(n[d]=[]),E(n[d],[i])):(delete n[d],t.push(d),o.push({chain:s.concat([d]),id:d})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function E(e,t){for(var n=0;n<t.length;n++){var o=t[n];-1===e.indexOf(o)&&e.push(o)}}t=t||{};var v={},m=[],y={},_=function(){console.warn("[HMR] unexpected require("+g.moduleId+") to disposed module")};for(var C in f)if(Object.prototype.hasOwnProperty.call(f,C)){var g;d=b(C);var O=!1,D=!1,j=!1,S="";switch((g=f[C]?l(d):{type:"disposed",moduleId:C}).chain&&(S="\nUpdate propagation: "+g.chain.join(" -> ")),g.type){case"self-declined":t.onDeclined&&t.onDeclined(g),t.ignoreDeclined||(O=new Error("Aborted because of self decline: "+g.moduleId+S));break;case"declined":t.onDeclined&&t.onDeclined(g),t.ignoreDeclined||(O=new Error("Aborted because of declined dependency: "+g.moduleId+" in "+g.parentId+S));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(g),t.ignoreUnaccepted||(O=new Error("Aborted because "+d+" is not accepted"+S));break;case"accepted":t.onAccepted&&t.onAccepted(g),D=!0;break;case"disposed":t.onDisposed&&t.onDisposed(g),j=!0;break;default:throw new Error("Unexception type "+g.type)}if(O)return u("abort"),Promise.reject(O);if(D)for(d in y[d]=f[d],E(m,g.outdatedModules),g.outdatedDependencies)Object.prototype.hasOwnProperty.call(g.outdatedDependencies,d)&&(v[d]||(v[d]=[]),E(v[d],g.outdatedDependencies[d]));j&&(E(m,[g.moduleId]),y[d]=_)}var A,H=[];for(o=0;o<m.length;o++)d=m[o],w[d]&&w[d].hot._selfAccepted&&H.push({module:d,errorHandler:w[d].hot._selfAccepted});u("dispose"),Object.keys(T).forEach(function(e){!1===T[e]&&function(e){delete installedChunks[e]}(e)});for(var L,P,B=m.slice();B.length>0;)if(d=B.pop(),c=w[d]){var J={},x=c.hot._disposeHandlers;for(i=0;i<x.length;i++)(n=x[i])(J);for(s[d]=J,c.hot.active=!1,delete w[d],delete v[d],i=0;i<c.children.length;i++){var k=w[c.children[i]];k&&((A=k.parents.indexOf(d))>=0&&k.parents.splice(A,1))}}for(d in v)if(Object.prototype.hasOwnProperty.call(v,d)&&(c=w[d]))for(P=v[d],i=0;i<P.length;i++)L=P[i],(A=c.children.indexOf(L))>=0&&c.children.splice(A,1);for(d in u("apply"),r=h,y)Object.prototype.hasOwnProperty.call(y,d)&&(e[d]=y[d]);var M=null;for(d in v)if(Object.prototype.hasOwnProperty.call(v,d)&&(c=w[d])){P=v[d];var I=[];for(o=0;o<P.length;o++)if(L=P[o],n=c.hot._acceptedDependencies[L]){if(-1!==I.indexOf(n))continue;I.push(n)}for(o=0;o<I.length;o++){n=I[o];try{n(P)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:d,dependencyId:P[o],error:e}),t.ignoreErrored||M||(M=e)}}}for(o=0;o<H.length;o++){var U=H[o];d=U.module,a=[d];try{R(d)}catch(e){if("function"==typeof U.errorHandler)try{U.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:d,error:n,originalError:e}),t.ignoreErrored||M||(M=n),M||(M=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:d,error:e}),t.ignoreErrored||M||(M=e)}}return M?(u("fail"),Promise.reject(M)):(u("idle"),new Promise(function(e){e(m)}))}var w={};function R(t){if(w[t])return w[t].exports;var o=w[t]={i:t,l:!1,exports:{},hot:function(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var o=0;o<e.length;o++)t._acceptedDependencies[e[o]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:C,apply:D,status:function(e){if(!e)return p;l.push(e)},addStatusHandler:function(e){l.push(e)},removeStatusHandler:function(e){var t=l.indexOf(e);t>=0&&l.splice(t,1)},data:s[e]};return n=void 0,t}(t),parents:(c=a,a=[],c),children:[]};return e[t].call(o.exports,o,o.exports,d(t)),o.l=!0,o.exports}R.m=e,R.c=w,R.d=function(e,t,n){R.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},R.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},R.t=function(e,t){if(1&t&&(e=R(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(R.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)R.d(n,o,function(t){return e[t]}.bind(null,o));return n},R.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return R.d(t,"a",t),t},R.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},R.p="",R.h=function(){return r},d("./src/index.js")(R.s="./src/index.js")}({"./src/constants/eventEmiterConstants.js":function(e,t){t.eventEmitterConstants={ADD_OBJECT_DATA:"ADD_OBJECT_DATA",ROTATE_OBJECT:"ROTATE_OBJECT",SCALE_OBJECT:"SCALE_OBJECT",DRAG_OBJECT:"DRAG_OBJECT",DELETE_OBJECT:"DELETE_SELECTED_OBJECT",SET_SELECTED_OBJECT:"SET_SELECTED_OBJECT",REPLACE_STATE_FROM_SAVE:"REPLACE_STATE_FROM_SAVE",GRID_HELPER_UPDATE:"GRID_HELPER_UPDATE"}},"./src/helpers/DragControls.js":function(e,t){THREE.DragControls=function(e,t,n){if(e instanceof THREE.Camera){console.warn("THREE.DragControls: Constructor now expects ( objects, camera, domElement )");var o=e;e=t,t=o}var r=new THREE.Plane;console.log(new THREE.Raycaster);var i=new THREE.Raycaster,s=new THREE.Vector2,a=new THREE.Vector3,c=new THREE.Vector3,d=null,l=null,p=!1,u=!1,E=this;function f(){n.addEventListener("mousemove",_,!1),n.addEventListener("mousedown",T,!1),n.addEventListener("mouseup",b,!1),n.addEventListener("mouseleave",b,!1),n.addEventListener("touchmove",C,!1),n.addEventListener("touchstart",g,!1),n.addEventListener("touchend",O,!1),document.addEventListener("keydown",v,!1),document.addEventListener("keyup",m,!1),n.addEventListener("dblclick",y)}function h(){n.removeEventListener("mousemove",_,!1),n.removeEventListener("mousedown",T,!1),n.removeEventListener("mouseup",b,!1),n.removeEventListener("mouseleave",b,!1),n.removeEventListener("touchmove",C,!1),n.removeEventListener("touchstart",g,!1),n.removeEventListener("touchend",O,!1),document.removeEventListener("keydown",v,!1),document.removeEventListener("keyup",m,!1),n.removeEventListener("dblclick",y)}function v(e){switch(e.keyCode){case 16:p=!0;break;case 17:u=!0}}function m(e){switch(e.keyCode){case 16:p=!1;break;case 17:u=!1}}function y(n){n.preventDefault(),i.setFromCamera(s,t);var o=i.intersectObjects(e,!0);o.length>0&&E.dispatchEvent({type:"dblclick",object:o[0].object.parent})}function _(o){o.preventDefault();var p=n.getBoundingClientRect();if(s.x=(o.clientX-p.left)/p.width*2-1,s.y=-(o.clientY-p.top)/p.height*2+1,i.setFromCamera(s,t),d&&E.enabled)return i.ray.intersectPlane(r,c),void E.dispatchEvent({type:"drag",_id:d._id,position:{...c.sub(a)}});i.setFromCamera(s,t);var u=i.intersectObjects(e,!0);if(u.length>0){var f=u[0].object.parent;r.setFromNormalAndCoplanarPoint(new THREE.Vector3(0,1,0),f.position),l!==f&&(E.dispatchEvent({type:"hoveron",object:f}),n.style.cursor="pointer",l=f)}else null!==l&&(E.dispatchEvent({type:"hoveroff",object:l}),n.style.cursor="auto",l=null)}function T(o){o.preventDefault(),i.setFromCamera(s,t);var l=i.intersectObjects(e,!0);if(l.length>0){if(p)return void E.dispatchEvent({type:"deleteObject",_id:l[0].object.parent._id});if(u)return void E.dispatchEvent({type:"shiftSelect",_id:l[0].object.parent._id});d=l[0].object.parent,i.ray.intersectPlane(r,c)&&a.copy(c).sub(d.position),n.style.cursor="move",E.dispatchEvent({type:"dragstart",object:d})}}function b(e){e.preventDefault(),d&&(E.dispatchEvent({type:"dragend",object:d}),d=null),n.style.cursor="auto"}function C(e){e.preventDefault(),e=e.changedTouches[0];var o=n.getBoundingClientRect();if(s.x=(e.clientX-o.left)/o.width*2-1,s.y=-(e.clientY-o.top)/o.height*2+1,i.setFromCamera(s,t),d&&E.enabled)return i.ray.intersectPlane(r,c)&&d.position.copy(c.sub(a)),void E.dispatchEvent({type:"drag",object:d})}function g(o){o.preventDefault(),o=o.changedTouches[0];var l=n.getBoundingClientRect();s.x=(o.clientX-l.left)/l.width*2-1,s.y=-(o.clientY-l.top)/l.height*2+1,i.setFromCamera(s,t);var p=i.intersectObjects(e);p.length>0&&(d=p[0].object,r.setFromNormalAndCoplanarPoint(t.getWorldDirection(r.normal),d.position),i.ray.intersectPlane(r,c)&&a.copy(c).sub(d.position),n.style.cursor="move",E.dispatchEvent({type:"dragstart",object:d}))}function O(e){e.preventDefault(),d&&(E.dispatchEvent({type:"dragend",object:d}),d=null),n.style.cursor="auto"}f(),this.enabled=!0,this.activate=f,this.deactivate=h,this.dispose=function(){h()},this.setObjects=function(){console.error("THREE.DragControls: setObjects() has been removed.")},this.on=function(e,t){console.warn("THREE.DragControls: on() has been deprecated. Use addEventListener() instead."),E.addEventListener(e,t)},this.off=function(e,t){console.warn("THREE.DragControls: off() has been deprecated. Use removeEventListener() instead."),E.removeEventListener(e,t)},this.notify=function(e){console.error("THREE.DragControls: notify() has been deprecated. Use dispatchEvent() instead."),E.dispatchEvent({type:e})}},THREE.DragControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.DragControls.prototype.constructor=THREE.DragControls},"./src/index.js":function(e,t,n){"use strict";n.r(t);var o=n("./src/constants/eventEmiterConstants.js");const r=function(){this.events={}};r.prototype.on=function(e,t){const n=this.events[e];n?n.push(t):this.events[e]=[t]},r.prototype.emit=function(e,...t){const n=this.events[e];n&&n.forEach(e=>e(...t))};var i=r;const s=new WebSocket("ws://localhost:3000"+window.location.pathname);let a=null;s.onopen=function(){console.log("Соединение установлено.")},s.onclose=function(e){e.wasClean?console.log("Соединение закрыто чисто"):console.log("Обрыв соединения"),console.log("Код: "+e.code+" причина: "+e.reason)},s.onmessage=function(e){console.log("Получены данные "+e.data);let t=JSON.parse(e.data);"INIT"===t.type&&(a=t.id,M({type:o.eventEmitterConstants.REPLACE_STATE_FROM_SAVE,state:t.state},"FROM_SERVER")),"ACTION"===t.type&&M(t.action,"FROM_SERVER")},s.onerror=function(e){console.log("Ошибка "+e.message)};let c=new THREE.Scene;var d=new THREE.DirectionalLight(16777215),l=new THREE.DirectionalLightHelper(d,5e3);c.add(l),c.add(d);var p=new THREE.AxesHelper(150);c.add(p),c.background=new THREE.Color(15790320);var u;n("./src/helpers/DragControls.js");THREE.Group.prototype=Object.assign(Object.create(THREE.Group.prototype),{getObjectData:function(){let e={_id:this._id,src:this.src,scale:this.scale,rotation:this.rotation,position:this.position,arrOfMaterialColors:{}};return this._id=e._id,this.traverse(function(t){if(console.log(t.constructor),t instanceof THREE.Mesh)if(Array.isArray(t.material)){let n=[];for(let e=0;e<t.material.length;e++)n.push("#"+t.material[e].color.getHexString());e.arrOfMaterialColors[t.ID]=n}else t.material&&(e.arrOfMaterialColors[t.ID]="#"+t.material.color.getHexString())}),e},deleteObject:function(){c.remove(this)},changeScale:function(e){return this.scale.set(e,e,e),this.scale},changeRotation:function(e){!function(e,t,n){(u=new THREE.Matrix4).makeRotationAxis(t.normalize(),n),e.matrix=u,e.rotation.setFromRotationMatrix(e.matrix)}(this,new THREE.Vector3(0,1,0),e)}});let E=document.getElementById("preloader");function f(){E.classList.add("visible")}function h(){E.classList.remove("visible")}const v={},m=[];function y(e){return new Promise(function(t,n){if(v[e]){let n=v[e].clone();t(n)}else{(new THREE.FBXLoader).load(e,function(n){v[e]=n.clone(),t(n)})}})}function _(e,t){return e._id=t._id,e.changeScale(t.scale),e.changeRotation(t.rotation),e.position.set(t.position.x,t.position.y,t.position.z),t.deleted}let T=document.getElementById("fileinput");T.addEventListener("change",()=>{!function(){var e,t,n;if("function"!=typeof window.FileReader)return void console.log("p","The file API isn't supported on this browser yet.");(e=document.getElementById("fileinput"))?e.files?e.files[0]?(t=e.files[0],(n=new FileReader).onload=function(){M({type:o.eventEmitterConstants.REPLACE_STATE_FROM_SAVE,state:JSON.parse(n.result)}),T.value=""},n.readAsText(t)):console.log("p","Please select a file before clicking 'Load'"):console.log("p","This browser doesn't seem to support the `files` property of file inputs."):console.log("p","Um, couldn't find the fileinput element.")}()});let b=new dat.GUI({autoPlace:!0}),C=b.addFolder("Add models"),g=[{name:"Model #1",src:"/sceneData/models/hous/YellowHouse.fbx"},{name:"Model #2",src:"/sceneData/models/Samba Dancing.fbx"},{name:"Model #2",src:"/sceneData/models/house3d.fbx"}];g=g.map(e=>({...e,[e.name]:()=>{M({type:o.eventEmitterConstants.ADD_OBJECT_DATA,_id:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}(),src:e.src})}}));for(let e=0;e<g.length;e++)C.add(g[e],g[e].name);let O=null;let D=b.addFolder("Edit"),w={save:function(){!function(e){let t=JSON.stringify(e),n="data:application/json;charset=utf-8,"+encodeURIComponent(t),o=document.createElement("a");o.setAttribute("href",n),o.setAttribute("download","data.json"),o.click()}(I.objectsScheme)},load:function(){T.click()}};D.add(w,"save"),D.add(w,"load");var R=b;const j=new THREE.WebGLRenderer;j.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(j.domElement);var S=j;const A=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e4);A.position.set(500,800,1300),A.lookAt(new THREE.Vector3);var H=A;const L=new THREE.OrbitControls(H,S.domElement);var P=new Stats;P.showPanel(0),document.body.appendChild(P.dom),requestAnimationFrame(function e(){P.begin(),S.render(c,H),P.end(),requestAnimationFrame(e)});var B=function(){S.render(c,H)};const J={gridHelper:{size:1e3,divisions:50},objectsScheme:{},selectedObject:null};window.sts=J;const x=new THREE.DragControls(m,H,S.domElement);x.addEventListener("dragstart",function(e){L.enabled=!1}),x.addEventListener("dragend",function(e){L.enabled=!0}),x.addEventListener("hoveron",function(e){e.object,J.selectedObject}),x.addEventListener("hoveroff",function(e){e.object,J.selectedObject}),x.addEventListener("drag",function(e){M({type:o.eventEmitterConstants.DRAG_OBJECT,_id:e._id,position:e.position})}),x.addEventListener("deleteObject",function(e){M({type:o.eventEmitterConstants.DELETE_OBJECT,_id:e._id})}),x.addEventListener("dblclick",function(e){M({type:o.eventEmitterConstants.SET_SELECTED_OBJECT,_id:e.object._id})});const k=new i;function M(e,t){"FROM_SERVER"!==t&&function(e){if(a){let t={action:e,id:a};s.send(JSON.stringify(t))}}(e);let n=function(){switch(e.type){case o.eventEmitterConstants.GRID_HELPER_UPDATE:e.size&&(J.gridHelper.size=e.size),e.divisions&&(J.gridHelper.divisions=e.divisions),k.emit(e.type);break;case o.eventEmitterConstants.REPLACE_STATE_FROM_SAVE:return J.objectsScheme=e.state,{type:"UPDATE_OBJECTS",payload:{type:"REPLACE_STATE_FROM_SAVE",objectsScheme:J.objectsScheme}};case o.eventEmitterConstants.ADD_OBJECT_DATA:{const{_id:n,src:o}=e;let r={_id:n,src:o,position:{x:0,y:0,z:0},scale:1,rotation:0,fromType:t};return J.objectsScheme[n]=r,{type:"UPDATE_OBJECTS",payload:{type:"ADD_OBJECT",objectScheme:r}}}case o.eventEmitterConstants.DRAG_OBJECT:return J.objectsScheme[e._id].position=e.position,{type:"UPDATE_OBJECTS",payload:{type:"DRAG_OBJECT",objectScheme:J.objectsScheme[e._id]}};case o.eventEmitterConstants.ROTATE_OBJECT:return J.objectsScheme[e._id].rotation=e.radians,{type:"UPDATE_OBJECTS",payload:{type:"ROTATE_OBJECT",objectScheme:J.objectsScheme[e._id]}};case o.eventEmitterConstants.SCALE_OBJECT:return J.objectsScheme[e._id].scale=e.scale,{type:"UPDATE_OBJECTS",payload:{type:"SCALE_OBJECT",objectScheme:J.objectsScheme[e._id]}};case o.eventEmitterConstants.DELETE_OBJECT:return J.objectsScheme[e._id].deleted=!0,delete J.objectsScheme[e._id],{type:"UPDATE_OBJECTS",payload:{type:"DELETE_OBJECT",objectId:e._id}};case o.eventEmitterConstants.SET_SELECTED_OBJECT:{let t=e._id;return J.selectedObject!==t&&(J.selectedObject=t),{type:"UPDATE_MENU",payload:{type:"SET_SELECTED_OBJECT",objectScheme:J.objectsScheme[e._id]}}}}}();n&&k.emit(n.type,n.payload)}k.on("UPDATE_OBJECTS",function(e){switch(e.type){case"REPLACE_STATE_FROM_SAVE":{const{objectsScheme:t}=e,n=Object.keys(t).map(e=>t[e]);f();let o=n.reduce((e,t)=>(-1===e.indexOf(t.src)&&e.push(t.src),e),[]);Promise.all(o.map(y)).then(()=>{Promise.all(n.map(e=>y(e.src))).then(e=>{for(let t=0;t<e.length;t++)_(e[t],n[t]);m.forEach(e=>{c.remove(e)}),m.length=0,e.forEach(e=>{c.add(e)}),m.push.apply(m,e),h()})});break}case"ADD_OBJECT":f(),y(e.objectScheme.src).then(t=>{_(t,e.objectScheme)||(c.add(t),m.push(t)),h()});break;case"DRAG_OBJECT":{const{x:t,y:n,z:o}=e.objectScheme.position;let r=m.find(t=>t._id===e.objectScheme._id);r&&r.position.set(t,n,o);break}case"ROTATE_OBJECT":{const{rotation:t,_id:n}=e.objectScheme;let o=m.find(e=>e._id===n);o&&o.changeRotation(t);break}case"SCALE_OBJECT":{const{scale:t,_id:n}=e.objectScheme;let o=m.find(e=>e._id===n);o&&o.changeScale(t);break}case"DELETE_OBJECT":{let t=m.find(t=>t._id===e.objectId);t&&c.remove(t),t&&m.splice(m.indexOf(t),1);break}}}),k.on("UPDATE_MENU",function(e){switch(e.type){case"SET_SELECTED_OBJECT":{let{objectScheme:t}=e;O&&(b.removeFolder(O),O=null),O=b.addFolder("Selected object");let n={rotation:t.rotation};O.add(n,"rotation",0,2*Math.PI,.01).onChange(function(e){M({type:o.eventEmitterConstants.ROTATE_OBJECT,_id:t._id,radians:e})});let r={scale:t.scale};O.add(r,"scale",.01,5,.01).onChange(function(e){M({type:o.eventEmitterConstants.SCALE_OBJECT,_id:t._id,scale:e})}),O.open();break}}}),k.on(o.eventEmitterConstants.GRID_HELPER_UPDATE,F);var I=J;let U=null;function F(){U&&c.remove(U);const{size:e,divisions:t}=I.gridHelper;U=new THREE.GridHelper(e,t),c.add(U)}F();const G={size:1e3,divisions:50};var V=R.addFolder("Grid Helper");V.add(G,"size",100,1e4).onChange(function(e){M({type:o.eventEmitterConstants.GRID_HELPER_UPDATE,size:e})}),V.add(G,"divisions",10,200).onChange(function(e){M({type:o.eventEmitterConstants.GRID_HELPER_UPDATE,divisions:e})}),V.open();var z=new THREE.PlaneBufferGeometry(800,800,800),N=(new THREE.TextureLoader).load("/sceneData/materials/download.jpeg");N.wrapS=THREE.RepeatWrapping,N.wrapT=THREE.RepeatWrapping,N.repeat.set(50,50);var q=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:N}),W=new THREE.Mesh(z,q);W.rotateX(Math.PI/2),c.add(W),B()}});